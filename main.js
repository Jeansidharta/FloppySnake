!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var r;n.r(t),function(e){e.vectorParser=function(e){return void 0===e?o.zero:e.constructor==Array?2==(e=e).length?new o(e):new o(e[0],e[1]):e=e}}(r||(r={}));class o{constructor(...e){if(e[0]&&e[0].constructor==Array){let t=e[0];this.x=t[0]||0,this.y=t[1]||0}else if(e[0]&&e[0].constructor==o){let t=e[0];this.x=t.x,this.y=t.y}else this.x=e[0]||0,this.y=e[1]||0}static get zero(){return new o(0,0)}static get up(){return new o(0,-1)}static get down(){return new o(0,1)}static get left(){return new o(-1,0)}static get right(){return new o(1,0)}set(e){return e.constructor==Array?(e=e,this.x=e[0],this.y=e[1]):(e=e,this.x=e.x,this.y=e.y),this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}draw(e,t){return e=r.vectorParser(e),t.beginPath(),e=e,t.moveTo(e.x,e.y),t.lineTo(e.x+this.x,e.y+this.y),t.stroke(),this}duplicate(){return new o(this.x,this.y)}static duplicate(e){return new o(e.x,e.y)}toString(){return`[${this.x}, ${this.y}]`}toArray(){return[this.x,this.y]}add(e){return e=r.vectorParser(e),this.x+=e.x,this.y+=e.y,this}static add(e,t){return e=r.vectorParser(e),t=r.vectorParser(t),new o(e.x+t.x,e.y+t.y)}addNew(e){return e=r.vectorParser(e),new o(this.x+e.x,this.y+e.y)}subtract(e){return e=r.vectorParser(e),this.x-=e.x,this.y-=e.y,this}static subtract(e,t){return e=r.vectorParser(e),t=r.vectorParser(t),new o(e.x-t.x,e.y-t.y)}subtractNew(e){return e=r.vectorParser(e),new o(this.x-e.x,this.y-e.y)}scale(e){return this.x*=e,this.y*=e,this}static scale(e,t){return e=r.vectorParser(e),new o(e.x*t,e.y*t)}scaleNew(e){return new o(this.x*e,this.y*e)}dot(e){return e=r.vectorParser(e),this.x*e.x+this.y*e.y}static dot(e,t){return e=r.vectorParser(e),t=r.vectorParser(t),e.x*t.x+e.y*t.y}cross(e){e=r.vectorParser(e);let t=this.x*e.y-this.y*e.x;return t>0?1:t<0?-1:0}static cross(e,t){e=r.vectorParser(e),t=r.vectorParser(t);let n=e.x*t.y-e.y*t.x;return n>0?1:n<0?-1:0}static getOrtogonal(e){return e=r.vectorParser(e),new o(e.y,-e.x)}rotate(e){e*=Math.PI/180;let t=Math.sin(e),n=Math.cos(e),r=this.x,o=this.y;return this.x=r*n-o*t,this.y=r*t+o*n,this}static rotate(e,t){e=r.vectorParser(e),t*=Math.PI/180;let n=Math.sin(t),i=Math.cos(t);return new o(e.x*i-e.y*n,e.x*n+e.y*i)}rotateNew(e){e*=Math.PI/180;let t=Math.sin(e),n=Math.cos(e);return new o(this.x*n-this.y*t,this.x*t+this.y*n)}get sqrMagnitude(){return this.x*this.x+this.y*this.y}set sqrMagnitude(e){this.normalize().scale(Math.sqrt(e))}get magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}set magnitude(e){this.normalize().scale(e)}setMagnitude(e){return this.magnitude=e,this}static setMagnitude(e,t){let n=(e=r.vectorParser(e)).normalized;return n.scale(t),n}setMagnitudeNew(e){let t=this.normalized;return t.scale(e),t}get normalized(){let e=this.magnitude;return 0==e?(console.error("DIVIDED BY ZERO"),new o(0,0)):new o(this.x/e,this.y/e)}normalize(){let e=this.magnitude;return 0==e?this:(this.x/=e,this.y/=e,this)}static project(e,t){return e=r.vectorParser(e),(t=r.vectorParser(t)).scaleNew(e.dot(t)/t.sqrMagnitude)}projectNew(e){return e=r.vectorParser(e),o.project(this,e)}}let i="\n.snake-segment{\n   width : 30px;\n   height : 30px;\n   display : inline-block;\n   position : absolute;\n}\n\n.snake-head{\n   background-color : #ff0000;\n}\n\n.snake-body{\n   background-color : #00ff00;\n}\n";const s=30;class l{constructor(e,t,n){this.position=e,this.direction=t,this.div=document.createElement("div"),this.div.className="snake-segment "+n,this.updateTransform()}get size(){return s}updateTransform(){let e=o.getOrtogonal(this.direction);this.div.style.transform="matrix("+`${e.x}, ${e.y},`+`${this.direction.x}, ${this.direction.y},`+`${this.position.x}, ${this.position.y}`+")"}}class a{constructor(){if(this.segments=[],this.size=s,this.headColor="#ff0000",this.bodyColor="#00ff00",this.length=0,this.container=document.getElementsByTagName("board-elem-test")[0],void 0===this.container)throw"WHERE IS DA BOARD";let e=document.createElement("style");e.innerHTML=i,this.container.appendChild(e);for(let e=0;e<a.initialLength;e++)this.createSegment()}get direction(){return this.segments[0].direction}get headPos(){return this.segments[0].position}get head(){return this.segments[0]}move(e){this.segments[0].position.add(this.segments[0].direction.scaleNew(e)),this.segments[0].updateTransform();for(let t=1;t<this.segments.length;t++){let n=this.segments[t],r=this.segments[t-1];n.position.add(n.direction.scaleNew(e));let o=r.position.subtractNew(n.position);n.position=r.position.subtractNew(o.setMagnitude(this.size)),n.direction=r.position.subtractNew(n.position).normalize(),n.updateTransform()}}gameOver(){return new Promise((e,t)=>{let n=setInterval(()=>{this.container.removeChild(this.segments[0].div),this.segments.shift(),0==this.segments.length&&(clearInterval(n),e())},25)})}createSegment(){this.length++;let e=this.segments.length;if(0==e){let e=new o(this.container.clientWidth/2,this.container.clientHeight/2);this.segments.push(new l(e,new o(-1,0),"snake-head"))}else{let t=1==e?new o(1,0):this.segments[e-1].position.subtractNew(this.segments[e-2].position).normalize(),n=this.segments[e-1].position.addNew(t.scaleNew(this.size));this.segments.push(new l(n,t.scale(-1),"snake-body"))}this.container.appendChild(this.segments[e].div)}grow(){this.createSegment()}turn(e){this.segments[0].direction.rotate(e)}}var c,u;a.initialLength=4,function(e){let t,n=Object.create(null);e.targetElement=null;let r=Object.create(null),o=Object.create(null),i=Object.create(null),s=[],l=[],a=[];function c(){let e=Object.keys(n);if(a.length>0&&e.length>0)for(let e=0;e<a.length;e++)a[e]();for(let t=0;t<e.length;t++){let n=i[e[t]];if(n)if(n.constructor==Array)for(let e=0;e<n.length;e++)n[e]();else n()}}function u(e,t,n){let r=t[e];if(r)if(r.constructor==Array)for(let e=0;e<r.length;e++)r[e]();else r();for(let e=0;e<n.length;e++)n[e]()}function d(e){let t=e.key.toLowerCase();null==n[t]&&(n[t]=!0,u(t,r,s))}function h(e){let t=e.key.toLowerCase();null!=n[t]&&(delete n[t],u(t,o,l))}e.isKeyDown=function(e){return void 0===e?Object.keys(n).length>0:void 0!==n[e]},e.on=function(e,t,n){function c(e,t,n,r){if(void 0===r)return void t.push(n);let o=e[r];void 0===o?e[r]=n:o.constructor==Array?o.push(n):e[r]=[o,n]}return"keydown"==e&&c(r,s,t,n),"keyframe"==e&&c(i,a,t,n),"keyup"==e&&c(o,l,t,n),t},e.removeEvent=function(e,t,n){function c(e,t,n,r){if(void 0===r){for(let e=0;e<t.length;e++)if(t[e]===n)return t.splice(e,1),!0;return!1}let o=e[r];if(void 0===o)return!1;if(o.constructor==Array){o=o;for(let e=0;e<o.length;e++)o[e]===n&&o.splice(e,1)}else delete e[r];return!0}return"keydown"==e?c(r,s,t,n):"keyframe"==e?c(i,a,t,n):"keyup"==e&&c(o,l,t,n)},e.listenToElement=function(n,r=0){null!==e.targetElement&&(clearInterval(t),e.targetElement.removeEventListener("keydown",d),e.targetElement.removeEventListener("keyup",h)),e.targetElement=void 0===n?document.getElementsByTagName("body")[0]:n,e.targetElement.addEventListener("keydown",d),e.targetElement.addEventListener("keyup",h),t=setInterval(c,r)},e.clearEvents=function(e,t){void 0===e?(r=Object.create(null),o=Object.create(null),i=Object.create(null),s=[],a=[],l=[]):"keydown"==e?void 0===t?r=Object.create(null):delete r[t]:"keyup"==e?void 0===t?o=Object.create(null):delete o[t]:"keyframe"==e?void 0===t?i=Object.create(null):delete i[t]:"anykeydown"==e?s=[]:"anykeyup"==e?l=[]:"anykeyframe"==e&&(a=[])}}(c||(c={})),function(e){let t,n;!function(e){e[e.left=0]="left",e[e.middle=1]="middle",e[e.right=2]="right"}(t=e.Buttons||(e.Buttons={})),e.position=new o(0,0),e.deltaPosition=new o(0,0),e.deltaScroll=new o(0,0),e.targetElement=null,e.isLocked=!1;let r=Object.create(null),i=Object.create(null),s=Object.create(null),l=Object.create(null),a=[],c=[],u=[],d=[],h=[],m=[],g=[];function f(){let e=Object.keys(r);if(g.length>0&&e.length>0)for(let e=0;e<g.length;e++)g[e]();for(let t=0;t<e.length;t++){let n=l[e[t]];if(n)if(n.constructor==Array)for(let e=0;e<n.length;e++)n[e]();else n()}}function y(t){e.targetElement=e.targetElement,e.deltaPosition.x=t.movementX,e.deltaPosition.y=t.movementY,e.position.x=t.clientX-e.targetElement.offsetLeft,e.position.y=t.clientY-e.targetElement.offsetTop}function v(e,t,n){let r=e[n];if(void 0!==r)if(r.constructor==Array)for(let e=0;e<r.length;e++)r[e]();else r();if(t.length>0)for(let e=0;e<t.length;e++)h[e]()}function p(e){y(e),null==r[e.button]&&(r[e.button]=!0,v(i,h,e.button))}function E(e){y(e),null!=r[e.button]&&(delete r[e.button],v(s,m,e.button))}function w(e){y(e);for(let e=0;e<a.length;e++)a[e]()}function x(t){e.deltaScroll.x=t.deltaX,e.deltaScroll.y=t.deltaY;for(let e=0;e<c.length;e++)c[e]()}e.on=function(e,t,n){function r(e,t,n,r){if(void 0===r)return void t.push(n);let o=e[r];void 0===o?e[r]=n:o.constructor==Array?o.push(n):e[r]=[o,n]}return"mousedown"==e?r(i,h,t,n):"mouseframe"==e?r(l,g,t,n):"mouseup"==e?r(s,m,t,n):"mousemove"==e?a.push(t):"mousewheel"==e?c.push(t):"mouselock"==e?u.push(t):"mouseunlock"==e&&d.push(t),t},e.removeEvent=function(e,t,n){function r(e,t,n,r){if(void 0===r){for(let e=0;e<t.length;e++)if(t[e]===n)return t.splice(e,1),!0;return!1}let o=e[r];if(void 0===o)return!1;if(o.constructor==Array){o=o;for(let e=0;e<o.length;e++)o[e]===n&&o.splice(e,1)}else delete e[r];return!0}if("mousewheel"==e){for(let e=0;e<c.length;e++)if(c[e]===t)return c.splice(e,1),!0;return!1}if("mousemove"==e){for(let e=0;e<a.length;e++)if(a[e]===t)return a.splice(e,1),!0;return!1}if("mouselock"==e){for(let e=0;e<u.length;e++)if(u[e]===t)return u.splice(e,1),!0;return!1}if("mouseunlock"==e){for(let e=0;e<d.length;e++)if(d[e]===t)return d.splice(e,1),!0;return!1}return"mouseframe"==e?r(l,g,t,n):"mouseup"==e?r(s,m,t,n):"mousedown"==e&&r(i,h,t,n)},e.isButtonDown=function(e){return void 0===e?Object.keys(r).length>0:void 0!==r[e]},e.lock=function(){e.targetElement.requestPointerLock()},e.unlock=function(){document.exitPointerLock()},e.listenToElement=function(t={}){null!==e.targetElement&&(clearInterval(n),e.targetElement.addEventListener("mousemove",w),e.targetElement.addEventListener("mousedown",p),e.targetElement.addEventListener("mouseup",E),e.targetElement.addEventListener("wheel",x)),void 0===t.targetElement?(e.targetElement=document.getElementsByTagName("html")[0],void 0===e.targetElement&&(e.targetElement=document.getElementsByTagName("body")[0])):e.targetElement=t.targetElement;{let n=e.targetElement;function r(){let t=document;t.pointerLockElement===e.targetElement||t.mozPointerLockElement===e.targetElement?function(){e.isLocked=!0;for(let e=0;e<u.length;e++)u[e]()}():function(){e.isLocked=!1;for(let e=0;e<d.length;e++)d[e]()}()}n.requestPointerLock=n.requestPointerLock||n.mozRequestPointerLock,document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock,t.shouldLockMouse&&n.requestPointerLock(),"onpointerlockchange"in document?document.addEventListener("pointerlockchange",r,!1):"onmozpointerlockchange"in document&&document.addEventListener("mozpointerlockchange",r,!1)}function o(t){e.targetElement=e.targetElement,e.position.x=t.clientX-e.targetElement.offsetLeft,e.position.y=t.clientY-e.targetElement.offsetTop,e.targetElement.removeEventListener("mousemove",i),e.targetElement.removeEventListener("mousedown",s),e.targetElement.removeEventListener("mouseup",l),e.targetElement.removeEventListener("wheel",a),e.targetElement.addEventListener("mousemove",w),e.targetElement.addEventListener("mousedown",p),e.targetElement.addEventListener("mouseup",E),e.targetElement.addEventListener("wheel",x)}function i(e){o(e),w(e)}function s(e){o(e),p(e)}function l(e){o(e),E(e)}function a(e){o(e),x(e)}n=setInterval(f,t.updateRate||0),e.targetElement=e.targetElement,e.targetElement.addEventListener("contextmenu",function(e){e.preventDefault()}),e.targetElement.addEventListener("mousedown",s),e.targetElement.addEventListener("mousemove",i),e.targetElement.addEventListener("mouseup",l),e.targetElement.addEventListener("wheel",a)},e.clearEvents=function(e,t){void 0===e?(i=Object.create(null),s=Object.create(null),l=Object.create(null),a=[],c=[],u=[],d=[],h=[],m=[],g=[]):"mousedown"==e?void 0===t?i=Object.create(null):delete i[t]:"mouseup"==e?void 0===t?s=Object.create(null):delete s[t]:"mouseframe"==e?void 0===t?l=Object.create(null):delete l[t]:"mousemove"==e?a=[]:"mousewheel"==e?c=[]:"mouselock"==e?u=[]:"mouseunlock"==e?d=[]:"anymousedown"==e?h=[]:"anymouseframe"==e?g=[]:"anymouseup"==e&&(m=[])}}(u||(u={}));let d="\n.food{\n   background-color : rgb(255, 0, 255);\n   width : 30px;\n   height : 30px;\n   display : inline-block;\n   position : absolute;\n}\n";const h=30;class m{constructor(){if(this.div=document.createElement("div"),this.div.className="food",this.container=document.getElementsByTagName("board-elem-test")[0],void 0===this.container)throw"WHERE IS DA BOARD";let e=this.container.clientWidth-2*h,t=this.container.clientHeight-2*h;this.position=new o(Math.floor(Math.random()*e+h),Math.floor(Math.random()*t+h)),this.direction=new o(1,0),this.container.appendChild(this.div),this.updateTransform()}get size(){return h}static start(){let e=document.createElement("style");e.innerHTML=d,document.body.appendChild(e),setInterval(()=>{this.allFoods.length>2||Math.random()<.5||this.allFoods.push(new m)},1e3),setInterval(()=>{for(let e of this.allFoods)e.rotate(1)},0)}delete(){m.allFoods.splice(m.allFoods.indexOf(this),1),this.container.removeChild(this.div)}rotate(e){this.direction.rotate(e),this.updateTransform()}updateTransform(){let e=o.getOrtogonal(this.direction);this.div.style.transform=`matrix(\n         ${e.x}, ${e.y},\n         ${this.direction.x}, ${this.direction.y},\n         ${this.position.x}, ${this.position.y}\n      )`}}function g(e,t){let n=e.position.addNew([e.size,e.size]),r=t.position.addNew([t.size,t.size]);return n.subtract(r).sqrMagnitude<Math.pow(e.size+t.size,2)}function f(){clearInterval(y),clearInterval(p),c.clearEvents(),u.clearEvents(),v.gameOver().then(()=>{let e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div");e.style.position="absolute",e.style.display="inline-block",e.style.color="white";let r=document.getElementsByTagName("board-elem-test")[0];t.innerHTML="GAME OVER",t.style.fontFamily="monospaced",t.style.fontSize="100px",n.innerHTML="Score: "+(v.length-a.initialLength),n.style.fontFamily="monospaced",n.style.fontSize="20px",e.style.width="99%",e.style.textAlign="center",e.style.zIndex="100",r.appendChild(e),e.appendChild(t),e.appendChild(n);let o=0;e.style.opacity=o.toString(),setTimeout(()=>{let t=setInterval(()=>{o+=.001,e.style.opacity=o.toString(),1==o&&clearInterval(t)},0)},1e3)})}m.allFoods=[];let y=setInterval(()=>{for(let e of m.allFoods)g(v.head,e)&&(e.delete(),v.grow());for(let e=4;e<v.segments.length;e++)g(v.head,v.segments[e])&&f();(v.head.position.x<0||v.head.position.y<0||v.head.position.x>v.container.clientWidth||v.head.position.y>v.container.clientHeight)&&f()},0),v=new a;c.listenToElement(),u.listenToElement();let p,E=document.getElementsByTagName("board-elem-test")[0],w=document.createElement("div");w.innerHTML="Press space bar to start",w.style.textAlign="center",w.style.color="white",w.style.width="100%",w.style.fontSize="20px",E.appendChild(w);let x=c.on("keyup",()=>{E.removeChild(w),p=setInterval(()=>{v.move(2)},0),c.removeEvent("keyup",x),m.start(),c.on("keyframe",()=>{v.turn(-1)},"a"),c.on("keyframe",()=>{v.turn(1)},"d"),u.on("mouseframe",()=>{u.position.subtractNew(v.headPos).cross(v.direction)>0?v.turn(-1):v.turn(1)},u.Buttons.left),u.on("mouseframe",()=>{u.position.subtractNew(v.headPos).cross(v.direction)>0?v.turn(1):v.turn(-1)},u.Buttons.right)}," ")}]);